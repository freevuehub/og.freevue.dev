import { ImageResponse } from '@vercel/og'
import { COLOR_LIST, SECONDARY_COLOR } from '~/contant'

export const config = {
  runtime: 'edge',
}
const font = fetch(new URL('../../assets/BMDOHYEON.ttf', import.meta.url)).then((res) =>
  res.arrayBuffer()
)
const [primary, secodary] = COLOR_LIST[2023]
const primaryRGB = `rgb(${primary.join(',')})`
const SECONDARY_RGB = `rgb(${(secodary || SECONDARY_COLOR(primary)).join(',')})`
const COLOR = {
  WHITE: '#ffffff',
  TEXT: '',
  BACKGROUND: '#f5f5f5',
}
const og = async (props: any) => {
  const fontData = await font
  const image = props.nextUrl.searchParams.get('image')
  const title = props.nextUrl.searchParams.get('title')
  const desc = props.nextUrl.searchParams.get('desc')

  return new ImageResponse(
    (
      <div
        style={{
          width: '100%',
          height: '100%',
          display: 'flex',
          textAlign: 'center',
          justifyContent: 'center',
          alignItems: 'center',
          flexDirection: 'column',
          position: 'relative',
          paddingTop: '60px',
          backgroundColor: COLOR.WHITE,
          backgroundImage: 'url("http://localhost:3000/bg.jpg")',
          backgroundSize: '100%',
        }}
      >
        {/* <div
          style={{
            flex: 1,
            display: 'flex',
            width: '100%',
            alignItems: 'center',
          }}
        >
          <div
            style={{
              height: '100%',
              width: '60%',
              backgroundColor: SECONDARY_RGB,
              display: 'flex',
              alignItems: 'center',
              justifyContent: 'center',
              transform: 'skew(-20deg)',
              transformOrigin: 'left top',
              boxShadow: '0px 5px 10px #2e2e2e70',
            }}
          >
            <div
              style={{
                display: 'flex',
                alignItems: 'center',
                transform: 'skew(20deg)',
              }}
            >
              {title}
            </div>
          </div>
        </div> */}
        <div
          style={{
            width: '100%',
            backgroundColor: primaryRGB,
            boxShadow: '0px 5px 10px #2e2e2e70',
            position: 'absolute',
            top: 0,
            left: 0,
            height: '60px',
            marginRight: 'auto',
            padding: '0 40px',
            display: 'flex',
            alignItems: 'center',
            gap: '10px',
          }}
        >
          <img src="https://og.freevue.dev/api/logo?color=white&size=25&style=fit" alt="" />
          <h3
            style={{
              color: COLOR.WHITE,
              fontSize: '24px',
              fontFamily: 'EliceDigitalBaeum-Bd',
            }}
          >
            프리뷰 블로그
          </h3>
        </div>
        {/* <div
          style={{
            background: COLOR.BACKGROUND,
            display: 'flex',
            alignItems: 'center',
            justifyContent: 'center',
            flex: 1,
            width: '100%',
            height: '100%',
            gap: 40
          }}
          >
          <img src="https://og.freevue.dev/api/logo?size=80" alt="" style={{ width: '300px', height: '300px', display: 'flex', filter: 'drop-shadow(0px 5px 10px #2e2e2e70)' }} />
          <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <g data-name="Layer 2" id="Layer_2">
              <path d="M17.94,8h0L15,8.2,12.69,2H7.87L8.7,8.62,4,8.93V8H2v8H4v-.93l4.7.31L7.87,22h4.83L15,15.8l2.92.19H18a4,4,0,1,0-.06-8Zm-7.8-4h1.17l1.63,4.34-2.24.15Zm1.17,16H10.13l.56-4.48,2.24.15ZM18,14,4,13.06V10.94L18,10a2,2,0,0,1,0,4Z" />
            </g>
          </svg>
          <svg enable-background="new 0 0 91 91" height="91px" id="Layer_1" version="1.1" viewBox="0 0 91 91" width="91px" xmlSpace="preserve">
            <g>
              <path d="M25.23,56.588h-4.066c-0.771-1.031-1.99-1.709-3.373-1.709c-1.384,0-2.604,0.68-3.375,1.711h-1.672 c-0.984-2.34-3.3-3.988-5.995-3.988c-3.584,0-6.5,2.916-6.5,6.5s2.916,6.5,6.5,6.5c2.693,0,5.009-1.646,5.994-3.986h1.672 c0.771,1.033,1.991,1.711,3.376,1.711c1.386,0,2.607-0.68,3.377-1.713h4.062v2.879c0,1.389,1.125,2.514,2.513,2.514h3.785v6.268 c-0.141,0.105-0.279,0.215-0.406,0.336h-7.497c-0.985-2.338-3.301-3.986-5.995-3.986c-3.584,0-6.5,2.916-6.5,6.5 s2.916,6.5,6.5,6.5c2.694,0,5.01-1.646,5.995-3.988h6.709c0.713,1.326,2.096,2.238,3.703,2.238c2.329,0,4.224-1.895,4.224-4.223 c0-1.383-0.677-2.602-1.708-3.371v-6.273h7.891v7.967c-1.031,0.771-1.707,1.99-1.707,3.373c0,2.33,1.893,4.225,4.219,4.225 c2.33,0,4.225-1.895,4.225-4.225c0-1.383-0.68-2.604-1.711-3.373v-7.967h7.896v7.967c-1.029,0.771-1.707,1.99-1.707,3.373 c0,2.33,1.891,4.225,4.217,4.225c2.332,0,4.23-1.895,4.23-4.225c0-1.383-0.68-2.604-1.715-3.375v-8.283 c2.371-0.73,4.213-2.66,4.832-5.074h4.348c0.246,0.33,0.537,0.621,0.867,0.867v7.648c-2.34,0.984-3.988,3.301-3.988,5.994 c0,3.584,2.916,6.5,6.5,6.5s6.498-2.916,6.498-6.5c0-2.693-1.646-5.008-3.984-5.992v-7.652c1.031-0.77,1.711-1.99,1.711-3.373 c0-2.33-1.895-4.227-4.225-4.227c-1.383,0-2.604,0.678-3.375,1.709h-4.119v-4.443h1.822c0.771,1.035,1.992,1.715,3.379,1.715 c2.328,0,4.225-1.895,4.225-4.221c0-2.33-1.896-4.225-4.225-4.225c-1.381,0-2.6,0.676-3.369,1.705h-1.832v-7.891h5.816 c0.771,1.031,1.99,1.709,3.373,1.709c2.33,0,4.227-1.895,4.227-4.223s-1.896-4.223-4.227-4.223c-1.385,0-2.605,0.68-3.375,1.711 h-5.814V31.16c0-1.387-1.125-2.512-2.512-2.512h-2.553V22.25c0.328-0.246,0.619-0.535,0.865-0.863h7.395 c0.984,2.338,3.301,3.986,5.994,3.986c3.582,0,6.498-2.916,6.498-6.5s-2.916-6.5-6.498-6.5c-2.693,0-5.01,1.646-5.994,3.988 h-7.395c-0.771-1.033-1.994-1.713-3.381-1.713c-2.326,0-4.217,1.895-4.217,4.225c0,1.385,0.678,2.604,1.707,3.375v6.4H49.47 v-6.4c1.031-0.77,1.711-1.99,1.711-3.375c0-2.33-1.895-4.225-4.225-4.225c-2.326,0-4.219,1.895-4.219,4.225 c0,1.385,0.676,2.604,1.707,3.375v6.4h-7.891v-8.357c2.34-0.984,3.988-3.301,3.988-5.994c0-3.582-2.917-6.498-6.501-6.498 s-6.501,2.916-6.501,6.498c0,2.693,1.648,5.01,3.988,5.994v8.357h-3.785c-1.388,0-2.513,1.125-2.513,2.512v4.125h-4.066 c-0.771-1.031-1.99-1.709-3.373-1.709c-1.384,0-2.604,0.68-3.375,1.711H9.266v-4.186c2.338-0.986,3.984-3.301,3.984-5.992 c0-3.584-2.916-6.5-6.5-6.5s-6.5,2.916-6.5,6.5c0,2.693,1.649,5.01,3.991,5.994v6.695c0,1.389,1.125,2.514,2.513,2.514h7.663 c0.771,1.033,1.991,1.711,3.375,1.711c1.385,0,2.606-0.68,3.377-1.713h4.062v5.113h-4.068c-0.771-1.029-1.989-1.705-3.371-1.705 c-2.329,0-4.224,1.895-4.224,4.225c0,2.328,1.895,4.221,4.224,4.221c1.387,0,2.609-0.68,3.379-1.715h4.06V56.588z M6.75,60.576      c-0.813,0-1.475-0.662-1.475-1.475s0.662-1.475,1.475-1.475s1.475,0.662,1.475,1.475S7.563,60.576,6.75,60.576z M17.631,77.598      c-0.813,0-1.475-0.662-1.475-1.475s0.662-1.475,1.475-1.475c0.814,0,1.476,0.662,1.476,1.475S18.445,77.598,17.631,77.598z       M76.646,17.398c0.813,0,1.473,0.662,1.473,1.475s-0.66,1.475-1.473,1.475c-0.814,0-1.475-0.662-1.475-1.475      S75.831,17.398,76.646,17.398z M34.041,12.824c0.813,0,1.475,0.66,1.475,1.473s-0.662,1.475-1.475,1.475      c-0.814,0-1.476-0.662-1.476-1.475S33.227,12.824,34.041,12.824z M6.75,23.635c0.813,0,1.475,0.662,1.475,1.475      s-0.662,1.473-1.475,1.473s-1.475-0.66-1.475-1.473S5.937,23.635,6.75,23.635z M74.95,77.598c-0.813,0-1.475-0.662-1.475-1.475      s0.662-1.475,1.475-1.475s1.473,0.662,1.473,1.475S75.763,77.598,74.95,77.598z M30.256,33.674h32.175v26.162      c0,1.182-0.965,2.145-2.148,2.145H30.256V33.674z"/>
              <path d="M53.349,38.311H39.334c-1.388,0-2.513,1.125-2.513,2.514v14.008c0,1.387,1.125,2.512,2.513,2.512h14.015 c1.389,0,2.514-1.125,2.514-2.512V40.824C55.862,39.436,54.737,38.311,53.349,38.311z M50.837,52.318h-8.99v-8.982h8.99V52.318z" />
              <path d="M84.239,43.139c-3.586,0-6.502,2.916-6.502,6.5c0,3.582,2.916,6.498,6.502,6.498c3.582,0,6.496-2.916,6.496-6.498 C90.735,46.055,87.821,43.139,84.239,43.139z M84.239,51.111c-0.814,0-1.477-0.66-1.477-1.473c0-0.814,0.662-1.475,1.477-1.475 c0.811,0,1.471,0.66,1.471,1.475C85.71,50.451,85.05,51.111,84.239,51.111z"/>
            </g>
          </svg>
          <svg baseProfile="tiny" height="24px" version="1.2" viewBox="0 0 24 24" width="24px" xmlSpace="preserve" ><g id="Layer_1"><path d="M18,16.184v-1.851c0-1.93-1.57-3.5-3.5-3.5c-0.827,0-1.5-0.673-1.5-1.5V7.816C14.161,7.401,15,6.302,15,5   c0-1.654-1.346-3-3-3S9,3.346,9,5c0,1.302,0.839,2.401,2,2.815v1.518c0,0.827-0.673,1.5-1.5,1.5c-1.93,0-3.5,1.57-3.5,3.5v1.851   C4.839,16.599,4,17.698,4,19c0,1.654,1.346,3,3,3s3-1.346,3-3c0-1.302-0.839-2.401-2-2.816v-1.851c0-0.827,0.673-1.5,1.5-1.5   c0.979,0,1.864-0.407,2.5-1.058c0.636,0.651,1.521,1.058,2.5,1.058c0.827,0,1.5,0.673,1.5,1.5v1.851c-1.161,0.415-2,1.514-2,2.816   c0,1.654,1.346,3,3,3s3-1.346,3-3C20,17.698,19.161,16.599,18,16.184z M7,20c-0.552,0-1-0.449-1-1s0.448-1,1-1s1,0.449,1,1   S7.552,20,7,20z M12,4c0.552,0,1,0.449,1,1s-0.448,1-1,1s-1-0.449-1-1S11.448,4,12,4z M17,20c-0.552,0-1-0.449-1-1s0.448-1,1-1   s1,0.449,1,1S17.552,20,17,20z"/></g></svg>
          {
            image && (
              <div style={{ display: 'flex', width: '300px', padding: '30px' }}>
                <img src={image} style={{ width: '100%', display: 'flex' }} alt="" />
              </div>
            )
          }
        </div> */}
        {false && (
          <p
            style={{
              fontSize: '30px',
              lineHeight: '1px',
              position: 'absolute',
              left: '50%',
              transform: 'translateX(-50%)',
              bottom: '18px',
            }}
          >
            {desc}
          </p>
        )}
      </div>
    ),
    {
      width: 1200,
      height: 600,
      fonts: [
        {
          name: 'EliceDigitalBaeum-Bd',
          data: fontData,
          style: 'normal',
        },
      ],
    }
  )
}

export default og
